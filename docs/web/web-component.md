# ç»„ä»¶è§£è€¦

> è‡ªå‰ç«¯ä¸‰å¤§æ¡†æ¶([Vue](https://vuejs.org), [React](https://reactjs.org), [Angular](https://angular.io))ä»¥åŠåèµ·ä¹‹ç§€[Svelte](https://svelte.dev)å‡ºç°ä¹‹åï¼Œå„ç§ç»„ä»¶ï¼Œè½®å­ã€‚å¤§å®¶éƒ½æ²¡å°‘é€ è¿‡ï¼Œä¸€äº›å¤§å…¬å¸æˆ–è€…æœ‰ç²¾åŠ›çš„äººï¼Œåœ¨ç ”ç©¶`LowCode`æˆ–`NoCode`ï¼Œä¹Ÿæœ‰ä¸€äº›è½åœ°æˆ–è€…å…·ä½“æ–¹æ¡ˆã€‚

## èƒŒæ™¯

ä½†å°±æˆ‘è‡ªèº«ç»å†åŠæ¥è§¦é¡¹ç›®è€Œè¨€ï¼Œé¡¹ç›®è¿˜æ˜¯åœç•™åœ¨å¦‚ä½•ç¼–å†™ç»„ä»¶çš„å±‚æ¬¡ä¸Šï¼Œç®€å•çš„å®ç°ä¸€äº›å¤ç”¨ã€‚ä¸€äº›å†å²é¡¹ç›®å› ä¸ºéœ€æ±‚çš„è¿­ä»£ï¼ŒåŠŸèƒ½åœ¨ä¸æ–­å¢åŠ ï¼Œå†™ä»£ç çš„äººå‘˜ä¹Ÿåœ¨ä¸æ–­æ›´æ›¿ï¼Œäº¤æ¥ã€‚å°±ä¼šå¯¼è‡´æœ€åçš„æ¥æ‰‹é¡¹ç›®çš„äººç—›è‹¦ä¸å ªï¼Œ~~é‡æ„ï¼Ÿä¸ç°å®ï¼Œæ—¶é—´ä¸å¤Ÿï¼Œä¹‹å‰çš„éœ€æ±‚ä¹Ÿä¸æ¸…æ¥šã€‚ç»§ç»­ä¿æŒï¼Ÿå°±é¢ä¸´ç€æ€ä¹ˆå»åœ¨åŸé¡¹ç›®ä¹‹ä¸Šç»§ç»­è¿­ä»£ã€‚~~ è¿›é€€ä¸¤éš¾ã€‚ã€‚ã€‚

åœ¨ä¹‹å‰çš„éœ€æ±‚æ¯«ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•å®Œæˆéœ€æ±‚åŠŸèƒ½çš„è¿­ä»£ï¼ŒUIæ”¹ç‰ˆï¼Ÿåªèƒ½é€šè¿‡å…¨å±€æœç´¢ä¸€äº›å…³é”®è¯ï¼Œå…³é”®å­—å»ä¸€æ­¥æ­¥å‘ä¸Šdebugæºç ã€‚å¦‚æœä»£ç ä¸­ç‰µæ‰¯è¿‡å¤šçš„ä¸šåŠ¡é€»è¾‘ï¼Œå°±å®Œå…¨æ‡µé€¼äº†ï¼ŒğŸ‘» çŸ¥é“ä¹‹å‰çš„éœ€æ±‚æ˜¯ä»€ä¹ˆ?_?!!!

ä»¥Reactä¸ºä¾‹ï¼Œå› ä¸ºæ¯ä¸ªäººéƒ½æœ‰è‡ªå·±å¯¹ç»„ä»¶çš„ç†è§£ï¼Œä¸åŒçš„äººç«™åœ¨ä¸åŒçš„ç»´åº¦å»å°è£…ï¼Œå°±å¯¼è‡´æœ€åçš„é¡¹ç›®ç»“æ„ï¼Œä»£ç ç»“æ„ä¹Ÿæ˜¯åƒå·®ä¸‡åˆ«ã€‚

* `æ— çŠ¶æ€ç»„ä»¶`: ä¸æ¶‰åŠè¿‡å¤šçŠ¶æ€äº¤äº’ï¼Œå¾ˆå®¹æ˜“å®ç°ï¼Œå¤§å®¶çš„æ€è·¯éƒ½å·®ä¸å¤šã€‚
* `æœ‰çŠ¶æ€ç»„ä»¶`: ä¸€æ—¦æ¶‰åŠåˆ°çŠ¶æ€ï¼Œä¸šåŠ¡é€»è¾‘ï¼Œäº¤äº’ã€‚ä¸€ä¸ªç»„ä»¶å°±å˜å¾—ä¸å†å¯æ§ã€‚æ¯ä¸ªäººçš„é£æ ¼ä¹Ÿéƒ½ä½“ç°çš„æ·‹æ¼“å°½è‡´ï¼
  * ç»„ä»¶å†…å‘èµ·è¯·æ±‚ï¼Œå„ç§è¯·æ±‚ï¼Œå¤§é‡æ¥å£ç›¸äº’ä¾èµ–ã€‚å¦‚æœæ¶‰åŠåˆ°å¤šä¸ªæ¥å£å¹¶è¡Œï¼Œåä¸€ä¸ªæ¥å£ä¾èµ–ä¸Šä¸€ä¸ªæ¥å£çš„è¿”å›å€¼ï¼Œå†™æ³•åˆæ˜¯å„æœ‰ç‰¹è‰²ã€‚
  * å‡ºç°å¤§é‡çš„ä¸šåŠ¡é€»è¾‘åˆ†æ”¯ï¼Œæ ¹æ®ä¸šåŠ¡`return`å‡ºä¸åŒçš„ç»„ä»¶â•¥ï¹â•¥
  * ç›´æ¥åœ¨ç»„ä»¶å†…å®ç°ä¸€ä¸ªæˆ–å¤šä¸ªå­ç»„ä»¶(ãƒã¸ï¿£ã€)
  * å­ç»„ä»¶ä¸ŠæŒ‚è½½ç€å¤§é‡çš„`props`ï¼Œå±æ€§æœ‰æ—¶å€™å¤šåˆ°ä»¤äººå‘æŒ‡ï¼Œæœ‰æ•°æ®ï¼Œæ–¹æ³•ï¼ŒçŠ¶æ€ï¼Œè‡ªå®šä¹‰çš„xxxï¼Œå„ç§ä¼ é€’ã€‚ o(â•¥ï¹â•¥)o
  * æ¬¢è¿å¤§å®¶ç»§ç»­è¡¥å……åæ§½...

## æ€è€ƒ

æˆ‘å¯¹æ•°æ®çš„ç†è§£ï¼Œå®ƒæ—¢è´´è¿‘äºä¸šåŠ¡å±‚ï¼Œä¹Ÿè€¦åˆç€äº¤äº’å±‚ï¼Œå¦‚æœä¸èƒ½å¾ˆå¥½çš„åˆ†ç¦»ç»„ç»‡è¿™ä¸‰å±‚ï¼Œå¾ˆå¯èƒ½ç‰µä¸€å‘è€ŒåŠ¨å…¨èº«ã€‚æ‰€ä»¥æ•°æ®æ˜¯æ ¸å¿ƒï¼Œæ—¢æ˜¯ä¸šåŠ¡çš„æ ¸å¿ƒï¼Œä¹Ÿæ˜¯ç»„ä»¶çš„æ ¸å¿ƒã€‚

* æ•°æ®ï¼Œä¸šåŠ¡é€»è¾‘ï¼Œäº¤äº’éƒ½ä¼šå½±å“æœ€ç»ˆéœ€è¦æ¸²æŸ“çš„UIè§†å›¾ã€‚
* ç¼–å†™ç»„ä»¶æ—¶ï¼Œé¦–å…ˆåˆ†æä¸šåŠ¡éœ€æ±‚ï¼Œå¯¹ç»„ä»¶è¿›è¡Œåˆ†å±‚ã€‚å¤§è‡´åˆ†ä¸º`æ•°æ®(DataSource)`ï¼Œ`äº¤äº’(Action)`ï¼Œ`UIè§†å›¾(View)`ä¸‰å±‚ã€‚
  * **æ•°æ®å¤„ç†(Handle)**: æ‰¿è½½ç€æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œå¯¹æ•°æ®è¿›è¡Œæ ¼å¼åŒ–è¾“å‡ºï¼Œä¾›UIç»„ä»¶è¿›è¡Œæ ‡å‡†åŒ–æ¥æ”¶ï¼Œä¸€èˆ¬ä»¥`function`å½¢å¼å­˜åœ¨ã€‚
  * **å‰¯ä½œç”¨(Effect)**: ä»¥æˆ‘ç›®å‰æ¥è§¦åˆ°çš„åœºæ™¯ï¼Œä¸»è¦è¿˜æ˜¯ä»¥äº‹ä»¶ä¿®æ”¹ç»„ä»¶çŠ¶æ€ï¼Œæ›´æ–°æ•°æ®åŠUIè§†å›¾ä¸ºä¸»ã€‚æ‰€ä»¥äº‹ä»¶åŠçŠ¶æ€å˜æ›´å¯èƒ½ä¼šåŒæ—¶å‡ºç°åœ¨`æ•°æ®å¤„ç†`å’Œ`UIè§†å›¾`ä¸­ã€‚åœ¨æ•°æ®å¤„ç†ä¸­ï¼Œ`è°ƒç”¨(Call)`æ–¹æ³•ï¼›åœ¨UIä¸­ï¼Œ`ç»‘å®š(Bind)`äº‹ä»¶åŠçŠ¶æ€ã€‚UIå±‚å°½é‡ä¸ç›´æ¥å¤„ç†æˆ–å°‘å¤„ç†æºæ•°æ®ã€‚

![ç»„ä»¶æ‹†åˆ†åŸåˆ™](./img/comp.png)

## ä¸¾ä¾‹

* ä¸šåŠ¡ä¸­å¸¸ä¼šæœ‰è¿™æ ·ä¸€ç§éœ€æ±‚ï¼Œç”¨æˆ·å¯ä»¥åŠ¨æ€çš„æ–°å¢åˆ é™¤ä¸€ä¸ªåˆ—è¡¨ï¼Œå› ä¸ºæ¯æ¬¡éœ€è¦å¤„ç†çš„æ•°æ®ï¼Œå’Œå±•ç¤ºçš„UIå½¢å¼éƒ½æ˜¯ä¸ç¡®å®šçš„ã€‚å¯èƒ½æˆ‘ä»¬æ¯æ¬¡åšéœ€æ±‚æ—¶éƒ½å®ç°ä¸€æ¬¡ä»£ç ï¼Œæˆ–è€…æŠŠæ–°å¢å’Œåˆ é™¤æ–¹æ³•æå–å‡ºæ¥ï¼Œå®ç°éƒ¨åˆ†å¤ç”¨ã€‚ä»¥`React Hook`ä¸ºä¾‹ï¼š

::: details Hooks: useDataOP

```js
/* hooks/useDataOP.js */
import { useState, useEffect } from 'react';
import { v4 as uuidv4 } from 'uuid';
import cloneDeep from 'lodash/cloneDeep';

// ä½¿ç”¨Symbolä½œä¸ºæ•°æ®çš„å”¯ä¸€key
const safeKey = Symbol('tid');

// æ ¼å¼åŒ–æºæ•°æ®
const opFmtData = (data) => {
  return cloneDeep(data).map((i) => {
    i[safeKey] = uuidv4();
    return i;
  });
};

/**
 * useDataOP
 * @author lencx
 * @param rawData - æºæ•°æ®
 */
export default function useDataOP(rawData = []) {
  const [opData, setData] = useState([]);
  const [opType, setType] = useState(null);
  const [isOk, setOk] = useState(true);

  // æ•°æ®åˆå§‹åŒ–
  useEffect(() => {
    if (Array.isArray(rawData)) {
      if (rawData.length > 0) {
        const data = opFmtData(rawData);
        setData(data);
      }
      setOk(true);
    } else {
      setOk(false);
    }
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, []);

  if (!isOk) return console.error('Parameter must be an array!');

  /**
   * æ–°å¢
   * @param data - æ–°å¢çš„æ•°æ®å¯¹è±¡
   */
  const opAdd = (data = {}) => {
    const result = [...opData, { [safeKey]: uuidv4(), ...data }];
    setData(result);
    setType('add');
    return result;
  };

  /**
   * åˆ é™¤
   * @param value - éœ€è¦åˆ é™¤çš„å€¼ï¼Œå¦‚æœä¸ºå­—ç¬¦ä¸²æˆ–æ•°å­—æ—¶ï¼Œéœ€è¦é…åˆkeyä½¿ç”¨ã€‚
   *   å¦‚æœvalueä¸ºå¯¹è±¡ï¼Œåˆ™ä¸ºéœ€è¦åˆ é™¤çš„è®°å½•ï¼Œé€šè¿‡safeKeyæŸ¥æ‰¾åˆ é™¤ã€‚
   * @param key - é»˜è®¤ä¸ºidï¼Œé€‰å¡«ï¼Œå¯çœç•¥
   */
  const opRemove = (value, key = 'id') => {
    let result;
    if (typeof value === 'string' || typeof value === 'number') {
      result = opData.filter((i) => i[key] !== value);
    } else {
      result = opData.filter((i) => i[safeKey] !== value[safeKey]);
    }
    setData(result);
    setType('remove');
    return result;
  };

  /**
   * æ’åº
   * @param startIndex - å½“å‰ä½ç½®
   * @param endIndex - ç›®æ ‡ä½ç½®
   */
  const opReorder = (startIndex, endIndex) => {
    const result = Array.from(opData);
    const [removed] = result.splice(startIndex, 1);
    result.splice(endIndex, 0, removed);
    setData(result);
    setType('reorder');
    return result;
  };

  return {
    opData,
    opType,
    opAdd,
    opRemove,
    opReorder,
    opRawData: rawData,
    opSafeKey: safeKey,
  };
}
```

```jsx
// ä½¿ç”¨useDataOP
import React, { useState } from 'react';
import useDataOP from '@/hooks/useDataOP';

export default () => {
  const { opData, opAdd, opRemove, opReorder, opSafeKey } = useDataOP([]);
  const [count, setCount] = useState(1);

  const handleAdd = () => {
    setCount(count+1);
    opAdd({ name: `test${count}` });
  }
  return (
    <div>
      <button onClick={handleAdd}>Add</button>
      {opData.map((i, idx) => {
        return (
          <div key={i[opSafeKey]}>
            <span>Name: {i.name}</span>
            {' '}
            <button onClick={() => opRemove(i)}>Remove</button>
            <button onClick={() => opReorder(idx, idx-1)}>Up+1</button>
            <button onClick={() => opReorder(idx, idx+1)}>Down-1</button>
          </div>
        )
      })}
    </div>
  );
}
```

:::

## æ€»ç»“

æ•°æ®ä¸UIçš„è§£è€¦ï¼Œå…¶å®å°±æ„å‘³ç€ä¸šåŠ¡é€»è¾‘ä¸UIç»„ä»¶è§†å›¾çš„è§£è€¦ã€‚å½“ç»„ä»¶è¦è·¨å¹³å°ï¼Œæˆ–è€…UIå¤§æ¢è‚¤æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦å®ç°æ ‡å‡†çš„æ•°æ®æ¥æ”¶ç»„ä»¶å°±å¯ä»¥äº†ã€‚ä¸šåŠ¡åŠŸèƒ½å¯¹åº”çš„å…¶å®å°±æ˜¯ä¸€ä¸ªä¸ªæ•°æ®å¤„ç†å‡½æ•°å’ŒUIç»„ä»¶çš„ç»„åˆï¼Œé€šè¿‡äº‹ä»¶å»è§¦å‘æˆ–è€…ç»‘å®šä¸€äº›çŠ¶æ€ã€‚å½“æ•°æ®å¤„ç†æˆ–ç»„ä»¶ä¸æ»¡è¶³éœ€æ±‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦å»æ‰©å±•å¯¹åº”çš„å‡½æ•°æˆ–ç»„ä»¶ã€‚

## ç›¸å…³é“¾æ¥

### Low Code

* [awesome-lowcode](https://github.com/taowen/awesome-lowcode): å›½å†…ä½ä»£ç å¹³å°ä»ä¸šè€…äº¤æµ
* [JSX Lite](https://github.com/BuilderIO/jsx-lite): Write components once, run everywhere. Compiles to Vue, React, Solid, and Liquid. Import code from Figma and Builder.io
