{"id":"D_kwDOEUMBcs4ANqol","title":"æ»šåŠ¨è¿›åº¦æ¡","bodyHTML":"<blockquote>\n<p dir=\"auto\">å­¦ä¹ æ¡†æ¶è¯­è¨€ï¼Œå†™ä»£ç æ˜¯æœ€å¿«çš„å…¥é—¨æ–¹å¼ã€‚ä¸ºäº†ç»™åŸºäº <code class=\"notranslate\">vitepress</code> æ„å»ºçš„ Blog æ–°å¢åŠŸèƒ½ï¼Œç°å­¦ <code class=\"notranslate\">Vue3</code>ï¼Œè¯ç”Ÿäº†ä¸‹é¢çš„è¿›åº¦æ¡ç»„ä»¶ã€‚</p>\n</blockquote>\n<p dir=\"auto\"><a href=\"https://code.lencx.tech/\" rel=\"nofollow\">ä½“éªŒåœ°å€</a> - æ‰‹å†™ Code Snippets ç³»åˆ—</p>\n<p dir=\"auto\">åˆ›å»ºä¸€ä¸ªè¿›åº¦æ¡ï¼Œç”¨æ¥æŒ‡ç¤ºé¡µé¢æ»šåŠ¨ç™¾åˆ†æ¯”ï¼Œä¸»è¦æœ‰ä¸¤ç‚¹æ³¨æ„äº‹é¡¹åŠä¸€ä¸ªæ€è€ƒï¼š</p>\n<ul dir=\"auto\">\n<li>ä½¿ç”¨ <code class=\"notranslate\">position: fixed</code> å°†æ»šåŠ¨è¿›åº¦æ¡ç½®äºé¡µé¢é¡¶éƒ¨ï¼Œ<code class=\"notranslate\">z-index</code> è®¾ç½®ä¸€ä¸ªè¾ƒå¤§çš„å€¼æ˜¯ä¸ºäº†ä¿è¯å…ƒç´ åœ¨é¡µé¢å†…å®¹çš„æœ€ä¸Šå±‚ã€‚</li>\n<li>ä½¿ç”¨ <code class=\"notranslate\">EventTarget.addEventListener</code> å’Œ <code class=\"notranslate\">Element.scrollTop</code> æ¥ç¡®å®šæ–‡æ¡£çš„æ»šåŠ¨ç™¾åˆ†æ¯”å¹¶å°†å…¶è®¾ç½®ä¸ºæ»šåŠ¨è¿›åº¦æ¡çš„å®½åº¦ã€‚</li>\n<li>æ€è€ƒ - å¦‚æœé¡µé¢å®¹å™¨é«˜åº¦å‘ç”Ÿå˜åŒ–ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</li>\n</ul>\n<h2 dir=\"auto\">ğŸ’  æ ¸å¿ƒ</h2>\n<div class=\"highlight highlight-text-html-basic notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"&lt;div id=&quot;scroll_progress_bar&quot;&gt;&lt;/div&gt;\"><pre class=\"notranslate\"><span class=\"pl-kos\">&lt;</span><span class=\"pl-ent\">div</span> <span class=\"pl-c1\">id</span>=\"<span class=\"pl-s\">scroll_progress_bar</span>\"<span class=\"pl-kos\">&gt;</span><span class=\"pl-kos\">&lt;/</span><span class=\"pl-ent\">div</span><span class=\"pl-kos\">&gt;</span></pre></div>\n<div class=\"highlight highlight-source-css notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"#scroll_progress_bar {\n  position: fixed;\n  top: 0;\n  width: 0%;\n  height: 4px;\n  background: #7983ff;\n  z-index: 10000;\n}\"><pre class=\"notranslate\"><span class=\"pl-kos\">#</span><span class=\"pl-c1\">scroll_progress_bar</span> {\n  <span class=\"pl-c1\">position</span><span class=\"pl-kos\">:</span> fixed;\n  <span class=\"pl-c1\">top</span><span class=\"pl-kos\">:</span> <span class=\"pl-c1\">0</span>;\n  <span class=\"pl-c1\">width</span><span class=\"pl-kos\">:</span> <span class=\"pl-c1\">0<span class=\"pl-smi\">%</span></span>;\n  <span class=\"pl-c1\">height</span><span class=\"pl-kos\">:</span> <span class=\"pl-c1\">4<span class=\"pl-smi\">px</span></span>;\n  <span class=\"pl-c1\">background</span><span class=\"pl-kos\">:</span> <span class=\"pl-pds\"><span class=\"pl-kos\">#</span>7983ff</span>;\n  <span class=\"pl-c1\">z-index</span><span class=\"pl-kos\">:</span> <span class=\"pl-c1\">10000</span>;\n}</pre></div>\n<div class=\"highlight highlight-source-js notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"const scrollProgress = document.getElementById('scroll_progress_bar');\n// æ»šåŠ¨æ¡é«˜åº¦\nconst height = document.documentElement.scrollHeight - document.documentElement.clientHeight;\n\nwindow.addEventListener('scroll', () =&gt; {\n  const scrollTop = document.body.scrollTop || document.documentElement.scrollTop;\n  // å½“å‰è¿›åº¦æ¡è¿›åº¦ = å½“å‰æ»šåŠ¨æ¡ä½ç½® / æ»šåŠ¨æ¡é«˜åº¦\n  scrollProgress.style.width = `${(scrollTop / height) * 100}%`;\n});\"><pre class=\"notranslate\"><span class=\"pl-k\">const</span> <span class=\"pl-s1\">scrollProgress</span> <span class=\"pl-c1\">=</span> <span class=\"pl-smi\">document</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">getElementById</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'scroll_progress_bar'</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-c\">// æ»šåŠ¨æ¡é«˜åº¦</span>\n<span class=\"pl-k\">const</span> <span class=\"pl-s1\">height</span> <span class=\"pl-c1\">=</span> <span class=\"pl-smi\">document</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">documentElement</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">scrollHeight</span> <span class=\"pl-c1\">-</span> <span class=\"pl-smi\">document</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">documentElement</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">clientHeight</span><span class=\"pl-kos\">;</span>\n\n<span class=\"pl-smi\">window</span><span class=\"pl-kos\">.</span><span class=\"pl-en\">addEventListener</span><span class=\"pl-kos\">(</span><span class=\"pl-s\">'scroll'</span><span class=\"pl-kos\">,</span> <span class=\"pl-kos\">(</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">=&gt;</span> <span class=\"pl-kos\">{</span>\n  <span class=\"pl-k\">const</span> <span class=\"pl-s1\">scrollTop</span> <span class=\"pl-c1\">=</span> <span class=\"pl-smi\">document</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">body</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">scrollTop</span> <span class=\"pl-c1\">||</span> <span class=\"pl-smi\">document</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">documentElement</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">scrollTop</span><span class=\"pl-kos\">;</span>\n  <span class=\"pl-c\">// å½“å‰è¿›åº¦æ¡è¿›åº¦ = å½“å‰æ»šåŠ¨æ¡ä½ç½® / æ»šåŠ¨æ¡é«˜åº¦</span>\n  <span class=\"pl-s1\">scrollProgress</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">style</span><span class=\"pl-kos\">.</span><span class=\"pl-c1\">width</span> <span class=\"pl-c1\">=</span> <span class=\"pl-s\">`<span class=\"pl-s1\"><span class=\"pl-kos\">${</span><span class=\"pl-kos\">(</span><span class=\"pl-s1\">scrollTop</span> <span class=\"pl-c1\">/</span> <span class=\"pl-s1\">height</span><span class=\"pl-kos\">)</span> <span class=\"pl-c1\">*</span> <span class=\"pl-c1\">100</span><span class=\"pl-kos\">}</span></span>%`</span><span class=\"pl-kos\">;</span>\n<span class=\"pl-kos\">}</span><span class=\"pl-kos\">)</span><span class=\"pl-kos\">;</span></pre></div>\n<h2 dir=\"auto\">âœï¸ å®ç°</h2>\n<h3 dir=\"auto\">ğŸ”¶ Vue3</h3>\n<div class=\"highlight highlight-text-html-vue notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"&lt;!-- ScrollProgress.vue --&gt;\n\n&lt;script setup lang=&quot;ts&quot;&gt;\nimport { ref, onMounted, onUnmounted } from 'vue'\n\n// åœ¨ `&lt;script setup&gt;` æ ‡ç­¾ä¸‹è¦ä½¿ç”¨ `props`ï¼Œåˆ™éœ€è¦ä½¿ç”¨ `defineProps` è¿›è¡Œå£°æ˜\nconst props = defineProps({\n  // æ»šåŠ¨å®¹å™¨ - å¦‚æœå®¹å™¨é«˜åº¦ä¼šå‘ç”Ÿå˜åŒ–ï¼Œåˆ™éœ€è¦å¯¹å…¶è¿›è¡Œç›‘å¬ï¼Œå¦åˆ™ä¼šæ»šåŠ¨è¿›åº¦ä¼šå‡ºç°è®¡ç®—è¯¯å·®\n  root: {\n    type: String,\n    default: '#app',\n    required: false,\n  },\n  // æ»šåŠ¨æ¡çš„é«˜åº¦\n  height: {\n    type: String,\n    default: '4px',\n    required: false,\n  },\n  // æ»šåŠ¨æ¡é¢œè‰²\n  theme: {\n    type: String,\n    default: '#3eaf7c',\n    required: false,\n    validator: (v: string) =&gt; {\n      document.head.style.color = v\n      const q = document.head.style.color\n      document.head.style.color = ''\n      return !!q\n    },\n  },\n  // æ»šåŠ¨æ¡æ”¾ç½®çš„ä½ç½®ï¼šé¡¶éƒ¨æˆ–åº•éƒ¨\n  placement: {\n    type: String,\n    default: 'top',\n    required: false,\n    validator: (v: string) =&gt; {\n      if (!['top', 'bottom'].includes(v)) {\n        console.error(`[ScrollProgress(placement)] The value must match one of these strings: 'top' | 'bottom'`)\n        return false\n      }\n      return true\n    },\n  },\n  // æ»šåŠ¨æ¡åœ¨é¡µé¢ä¸­çš„å±‚çº§\n  zIndex: {\n    type: [Number, String],\n    default: 10000,\n    required: false,\n    validator: (v: string) =&gt; /^-?[\\d]+$/.test(v),\n  },\n})\n\nconst el = ref(null)\nconst appHeight = ref(0)\n\n// ä¸ºäº†é¿å…è¿›åº¦æ¡å› é¡µé¢å®¹å™¨é«˜åº¦å˜åŒ–å¯¼è‡´è®¡ç®—åå·®ï¼Œéœ€è¦å¯¹é¡µé¢å®¹å™¨è¿›è¡Œç›‘å¬ï¼ŒåŠ¨æ€è·å–å…¶é«˜åº¦\nonMounted(() =&gt; {\n  // éœ€è¦è§‚å¯Ÿå˜åŠ¨çš„èŠ‚ç‚¹\n  const targetNode = document.querySelector(props.root)\n  if (!targetNode) return console.error(`[ScrollProgress(root)] '${props.root}' is invalid`)\n  // è§‚å¯Ÿå™¨çš„é…ç½®ï¼ˆéœ€è¦è§‚å¯Ÿä»€ä¹ˆå˜åŠ¨ï¼‰\n  const config = { attributes: true, childList: false, subtree: true }\n  // åˆ›å»ºä¸€ä¸ªè§‚å¯Ÿå™¨å®ä¾‹å¹¶ä¼ å…¥å½“è§‚å¯Ÿåˆ°å˜åŠ¨æ—¶æ‰§è¡Œçš„å›è°ƒå‡½æ•°\n  const observer = new MutationObserver((mutationsList: MutationRecord[]) =&gt; {\n    // Use traditional 'for loops' for IE 11\n    for(let mutation of mutationsList) {\n      if (mutation.type === 'attributes') {\n        appHeight.value = document.documentElement.scrollHeight\n      }\n    }\n  })\n  // å¼€å§‹è§‚å¯Ÿç›®æ ‡èŠ‚ç‚¹\n  observer.observe(targetNode, config)\n})\n\n// æ»šåŠ¨äº‹ä»¶æ‰§è¡Œçš„å›è°ƒå‡½æ•°\nconst listener = () =&gt; {\n  const scrollProgress = el.value\n  const height = appHeight.value - document.documentElement.clientHeight\n  const scrollTop = document.body.scrollTop || document.documentElement.scrollTop\n  scrollProgress.style.width = `${(scrollTop / height) * 100}%`\n}\n\nonMounted(() =&gt; window.addEventListener('scroll', listener))\nonUnmounted(() =&gt; window.removeEventListener('scroll', listener))\n\nconst style: any = {\n  background: props.theme,\n  zIndex: props.zIndex,\n  height: props.height,\n}\n\nif (props.placement === 'top') style.top = 0\nif (props.placement === 'bottom') style.bottom = 0\n\n// åœ¨ `&lt;script setup&gt;` æ ‡ç­¾ä¸‹æ˜¾å¼å…¬å¼€å±æ€§ï¼Œåˆ™éœ€è¦ä½¿ç”¨ `defineExpose`\ndefineExpose({ style })\n&lt;/script&gt;\n\n&lt;template&gt;\n  &lt;div id=&quot;scroll_progress&quot; ref=&quot;el&quot; :style=&quot;style&quot; /&gt;\n&lt;/template&gt;\n\n&lt;style scoped&gt;\n#scroll_progress {\n  position: fixed;\n  width: 0%;\n  transition: width 300ms ease-out;\n}\n&lt;/style&gt;\"><pre class=\"notranslate\"><span class=\"pl-c\"><span class=\"pl-c\">&lt;!--</span> ScrollProgress.vue <span class=\"pl-c\">--&gt;</span></span>\n\n<span class=\"pl-s1\">&lt;<span class=\"pl-ent\">script</span> <span class=\"pl-e\">setup</span> <span class=\"pl-e\">lang</span>=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>ts<span class=\"pl-pds\">\"</span></span>&gt;</span>\n<span class=\"pl-s1\"><span class=\"pl-k\">import</span> { <span class=\"pl-smi\">ref</span>, <span class=\"pl-smi\">onMounted</span>, <span class=\"pl-smi\">onUnmounted</span> } <span class=\"pl-k\">from</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>vue<span class=\"pl-pds\">'</span></span></span>\n<span class=\"pl-s1\"></span>\n<span class=\"pl-s1\"><span class=\"pl-c\"><span class=\"pl-c\">//</span> åœ¨ `&lt;script setup&gt;` æ ‡ç­¾ä¸‹è¦ä½¿ç”¨ `props`ï¼Œåˆ™éœ€è¦ä½¿ç”¨ `defineProps` è¿›è¡Œå£°æ˜</span></span>\n<span class=\"pl-s1\"><span class=\"pl-k\"><span class=\"pl-k\">const</span></span> props <span class=\"pl-k\">=</span> <span class=\"pl-en\">defineProps</span>({</span>\n<span class=\"pl-s1\">  <span class=\"pl-c\"><span class=\"pl-c\">//</span> æ»šåŠ¨å®¹å™¨ - å¦‚æœå®¹å™¨é«˜åº¦ä¼šå‘ç”Ÿå˜åŒ–ï¼Œåˆ™éœ€è¦å¯¹å…¶è¿›è¡Œç›‘å¬ï¼Œå¦åˆ™ä¼šæ»šåŠ¨è¿›åº¦ä¼šå‡ºç°è®¡ç®—è¯¯å·®</span></span>\n<span class=\"pl-s1\">  root: {</span>\n<span class=\"pl-s1\">    type: <span class=\"pl-c1\">String</span>,</span>\n<span class=\"pl-s1\">    default: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>#app<span class=\"pl-pds\">'</span></span>,</span>\n<span class=\"pl-s1\">    required: <span class=\"pl-c1\">false</span>,</span>\n<span class=\"pl-s1\">  },</span>\n<span class=\"pl-s1\">  <span class=\"pl-c\"><span class=\"pl-c\">//</span> æ»šåŠ¨æ¡çš„é«˜åº¦</span></span>\n<span class=\"pl-s1\">  height: {</span>\n<span class=\"pl-s1\">    type: <span class=\"pl-c1\">String</span>,</span>\n<span class=\"pl-s1\">    default: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>4px<span class=\"pl-pds\">'</span></span>,</span>\n<span class=\"pl-s1\">    required: <span class=\"pl-c1\">false</span>,</span>\n<span class=\"pl-s1\">  },</span>\n<span class=\"pl-s1\">  <span class=\"pl-c\"><span class=\"pl-c\">//</span> æ»šåŠ¨æ¡é¢œè‰²</span></span>\n<span class=\"pl-s1\">  theme: {</span>\n<span class=\"pl-s1\">    type: <span class=\"pl-c1\">String</span>,</span>\n<span class=\"pl-s1\">    default: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>#3eaf7c<span class=\"pl-pds\">'</span></span>,</span>\n<span class=\"pl-s1\">    required: <span class=\"pl-c1\">false</span>,</span>\n<span class=\"pl-s1\">    <span class=\"pl-en\">validator</span>: (<span class=\"pl-v\">v</span><span class=\"pl-k\">:</span> <span class=\"pl-c1\">string</span>) <span class=\"pl-k\">=&gt;</span> {</span>\n<span class=\"pl-s1\">      <span class=\"pl-c1\">document</span>.<span class=\"pl-smi\">head</span>.<span class=\"pl-c1\">style</span>.<span class=\"pl-c1\">color</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">v</span></span>\n<span class=\"pl-s1\">      <span class=\"pl-k\"><span class=\"pl-k\">const</span></span> q <span class=\"pl-k\">=</span> <span class=\"pl-c1\">document</span>.<span class=\"pl-smi\">head</span>.<span class=\"pl-c1\">style</span>.<span class=\"pl-c1\">color</span></span>\n<span class=\"pl-s1\">      <span class=\"pl-c1\">document</span>.<span class=\"pl-smi\">head</span>.<span class=\"pl-c1\">style</span>.<span class=\"pl-c1\">color</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span><span class=\"pl-pds\">'</span></span></span>\n<span class=\"pl-s1\">      <span class=\"pl-k\">return</span> <span class=\"pl-k\">!!</span><span class=\"pl-smi\">q</span></span>\n<span class=\"pl-s1\">    },</span>\n<span class=\"pl-s1\">  },</span>\n<span class=\"pl-s1\">  <span class=\"pl-c\"><span class=\"pl-c\">//</span> æ»šåŠ¨æ¡æ”¾ç½®çš„ä½ç½®ï¼šé¡¶éƒ¨æˆ–åº•éƒ¨</span></span>\n<span class=\"pl-s1\">  placement: {</span>\n<span class=\"pl-s1\">    type: <span class=\"pl-c1\">String</span>,</span>\n<span class=\"pl-s1\">    default: <span class=\"pl-s\"><span class=\"pl-pds\">'</span>top<span class=\"pl-pds\">'</span></span>,</span>\n<span class=\"pl-s1\">    required: <span class=\"pl-c1\">false</span>,</span>\n<span class=\"pl-s1\">    <span class=\"pl-en\">validator</span>: (<span class=\"pl-v\">v</span><span class=\"pl-k\">:</span> <span class=\"pl-c1\">string</span>) <span class=\"pl-k\">=&gt;</span> {</span>\n<span class=\"pl-s1\">      <span class=\"pl-k\">if</span> (<span class=\"pl-k\">!</span>[<span class=\"pl-s\"><span class=\"pl-pds\">'</span>top<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>bottom<span class=\"pl-pds\">'</span></span>].<span class=\"pl-en\">includes</span>(<span class=\"pl-smi\">v</span>)) {</span>\n<span class=\"pl-s1\">        <span class=\"pl-c1\">console</span>.<span class=\"pl-c1\">error</span>(<span class=\"pl-s\">`</span><span class=\"pl-s\">[ScrollProgress(placement)] The value must match one of these strings: 'top' | 'bottom'</span><span class=\"pl-s\">`</span>)</span>\n<span class=\"pl-s1\">        <span class=\"pl-k\">return</span> <span class=\"pl-c1\">false</span></span>\n<span class=\"pl-s1\">      }</span>\n<span class=\"pl-s1\">      <span class=\"pl-k\">return</span> <span class=\"pl-c1\">true</span></span>\n<span class=\"pl-s1\">    },</span>\n<span class=\"pl-s1\">  },</span>\n<span class=\"pl-s1\">  <span class=\"pl-c\"><span class=\"pl-c\">//</span> æ»šåŠ¨æ¡åœ¨é¡µé¢ä¸­çš„å±‚çº§</span></span>\n<span class=\"pl-s1\">  zIndex: {</span>\n<span class=\"pl-s1\">    type: [<span class=\"pl-c1\">Number</span>, <span class=\"pl-c1\">String</span>],</span>\n<span class=\"pl-s1\">    default: <span class=\"pl-c1\">10000</span>,</span>\n<span class=\"pl-s1\">    required: <span class=\"pl-c1\">false</span>,</span>\n<span class=\"pl-s1\">    <span class=\"pl-en\">validator</span>: (<span class=\"pl-v\">v</span><span class=\"pl-k\">:</span> <span class=\"pl-c1\">string</span>) <span class=\"pl-k\">=&gt;</span><span class=\"pl-sr\"> <span class=\"pl-pds\">/</span><span class=\"pl-k\">^</span>-<span class=\"pl-k\">?</span><span class=\"pl-c1\">[<span class=\"pl-c1\">\\d</span>]</span><span class=\"pl-k\">+</span><span class=\"pl-k\">$</span><span class=\"pl-pds\">/</span></span>.<span class=\"pl-c1\">test</span>(<span class=\"pl-smi\">v</span>),</span>\n<span class=\"pl-s1\">  },</span>\n<span class=\"pl-s1\">})</span>\n<span class=\"pl-s1\"></span>\n<span class=\"pl-s1\"><span class=\"pl-k\"><span class=\"pl-k\">const</span></span> el <span class=\"pl-k\">=</span> <span class=\"pl-en\">ref</span>(<span class=\"pl-c1\">null</span>)</span>\n<span class=\"pl-s1\"><span class=\"pl-k\"><span class=\"pl-k\">const</span></span> appHeight <span class=\"pl-k\">=</span> <span class=\"pl-en\">ref</span>(<span class=\"pl-c1\">0</span>)</span>\n<span class=\"pl-s1\"></span>\n<span class=\"pl-s1\"><span class=\"pl-c\"><span class=\"pl-c\">//</span> ä¸ºäº†é¿å…è¿›åº¦æ¡å› é¡µé¢å®¹å™¨é«˜åº¦å˜åŒ–å¯¼è‡´è®¡ç®—åå·®ï¼Œéœ€è¦å¯¹é¡µé¢å®¹å™¨è¿›è¡Œç›‘å¬ï¼ŒåŠ¨æ€è·å–å…¶é«˜åº¦</span></span>\n<span class=\"pl-s1\"><span class=\"pl-en\">onMounted</span>(() <span class=\"pl-k\">=&gt;</span> {</span>\n<span class=\"pl-s1\">  <span class=\"pl-c\"><span class=\"pl-c\">//</span> éœ€è¦è§‚å¯Ÿå˜åŠ¨çš„èŠ‚ç‚¹</span></span>\n<span class=\"pl-s1\">  <span class=\"pl-k\"><span class=\"pl-k\">const</span></span> targetNode <span class=\"pl-k\">=</span> <span class=\"pl-c1\">document</span>.<span class=\"pl-c1\">querySelector</span>(<span class=\"pl-smi\">props</span>.<span class=\"pl-smi\">root</span>)</span>\n<span class=\"pl-s1\">  <span class=\"pl-k\">if</span> (<span class=\"pl-k\">!</span><span class=\"pl-smi\">targetNode</span>) <span class=\"pl-k\">return</span> <span class=\"pl-c1\">console</span>.<span class=\"pl-c1\">error</span>(<span class=\"pl-s\">`</span><span class=\"pl-s\">[ScrollProgress(root)] '${<span class=\"pl-smi\">props</span>.<span class=\"pl-smi\">root</span>}' is invalid</span><span class=\"pl-s\">`</span>)</span>\n<span class=\"pl-s1\">  <span class=\"pl-c\"><span class=\"pl-c\">//</span> è§‚å¯Ÿå™¨çš„é…ç½®ï¼ˆéœ€è¦è§‚å¯Ÿä»€ä¹ˆå˜åŠ¨ï¼‰</span></span>\n<span class=\"pl-s1\">  <span class=\"pl-k\"><span class=\"pl-k\">const</span></span> config <span class=\"pl-k\">=</span> { attributes: <span class=\"pl-c1\">true</span>, childList: <span class=\"pl-c1\">false</span>, subtree: <span class=\"pl-c1\">true</span> }</span>\n<span class=\"pl-s1\">  <span class=\"pl-c\"><span class=\"pl-c\">//</span> åˆ›å»ºä¸€ä¸ªè§‚å¯Ÿå™¨å®ä¾‹å¹¶ä¼ å…¥å½“è§‚å¯Ÿåˆ°å˜åŠ¨æ—¶æ‰§è¡Œçš„å›è°ƒå‡½æ•°</span></span>\n<span class=\"pl-s1\">  <span class=\"pl-k\"><span class=\"pl-k\">const</span></span> observer <span class=\"pl-k\">=</span> <span class=\"pl-k\">new</span> <span class=\"pl-c1\">MutationObserver</span>((<span class=\"pl-v\">mutationsList</span><span class=\"pl-k\">:</span> <span class=\"pl-en\">MutationRecord</span>[]) <span class=\"pl-k\">=&gt;</span> {</span>\n<span class=\"pl-s1\">    <span class=\"pl-c\"><span class=\"pl-c\">//</span> Use traditional 'for loops' for IE 11</span></span>\n<span class=\"pl-s1\">    <span class=\"pl-k\">for</span>(<span class=\"pl-k\">let</span> mutation <span class=\"pl-k\">of</span> <span class=\"pl-smi\">mutationsList</span>) {</span>\n<span class=\"pl-s1\">      <span class=\"pl-k\">if</span> (<span class=\"pl-smi\">mutation</span>.<span class=\"pl-c1\">type</span> <span class=\"pl-k\">===</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>attributes<span class=\"pl-pds\">'</span></span>) {</span>\n<span class=\"pl-s1\">        <span class=\"pl-smi\">appHeight</span>.<span class=\"pl-c1\">value</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">document</span>.<span class=\"pl-c1\">documentElement</span>.<span class=\"pl-smi\">scrollHeight</span></span>\n<span class=\"pl-s1\">      }</span>\n<span class=\"pl-s1\">    }</span>\n<span class=\"pl-s1\">  })</span>\n<span class=\"pl-s1\">  <span class=\"pl-c\"><span class=\"pl-c\">//</span> å¼€å§‹è§‚å¯Ÿç›®æ ‡èŠ‚ç‚¹</span></span>\n<span class=\"pl-s1\">  <span class=\"pl-smi\">observer</span>.<span class=\"pl-c1\">observe</span>(<span class=\"pl-smi\">targetNode</span>, <span class=\"pl-smi\">config</span>)</span>\n<span class=\"pl-s1\">})</span>\n<span class=\"pl-s1\"></span>\n<span class=\"pl-s1\"><span class=\"pl-c\"><span class=\"pl-c\">//</span> æ»šåŠ¨äº‹ä»¶æ‰§è¡Œçš„å›è°ƒå‡½æ•°</span></span>\n<span class=\"pl-s1\"><span class=\"pl-k\"><span class=\"pl-k\">const</span></span> listener <span class=\"pl-k\">=</span> () <span class=\"pl-k\">=&gt;</span> {</span>\n<span class=\"pl-s1\">  <span class=\"pl-k\"><span class=\"pl-k\">const</span></span> scrollProgress <span class=\"pl-k\">=</span> <span class=\"pl-smi\">el</span>.<span class=\"pl-c1\">value</span></span>\n<span class=\"pl-s1\">  <span class=\"pl-k\"><span class=\"pl-k\">const</span></span> height <span class=\"pl-k\">=</span> <span class=\"pl-smi\">appHeight</span>.<span class=\"pl-c1\">value</span> <span class=\"pl-k\">-</span> <span class=\"pl-c1\">document</span>.<span class=\"pl-c1\">documentElement</span>.<span class=\"pl-smi\">clientHeight</span></span>\n<span class=\"pl-s1\">  <span class=\"pl-k\"><span class=\"pl-k\">const</span></span> scrollTop <span class=\"pl-k\">=</span> <span class=\"pl-c1\">document</span>.<span class=\"pl-c1\">body</span>.<span class=\"pl-smi\">scrollTop</span> <span class=\"pl-k\">||</span> <span class=\"pl-c1\">document</span>.<span class=\"pl-c1\">documentElement</span>.<span class=\"pl-smi\">scrollTop</span></span>\n<span class=\"pl-s1\">  <span class=\"pl-smi\">scrollProgress</span>.<span class=\"pl-c1\">style</span>.<span class=\"pl-c1\">width</span> <span class=\"pl-k\">=</span> <span class=\"pl-s\">`</span><span class=\"pl-s\">${(<span class=\"pl-smi\">scrollTop</span> <span class=\"pl-k\">/</span> <span class=\"pl-smi\">height</span>) <span class=\"pl-k\">*</span> <span class=\"pl-c1\">100</span>}%</span><span class=\"pl-s\">`</span></span>\n<span class=\"pl-s1\">}</span>\n<span class=\"pl-s1\"></span>\n<span class=\"pl-s1\"><span class=\"pl-en\">onMounted</span>(() <span class=\"pl-k\">=&gt;</span> <span class=\"pl-c1\">window</span>.<span class=\"pl-c1\">addEventListener</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>scroll<span class=\"pl-pds\">'</span></span>, <span class=\"pl-smi\">listener</span>))</span>\n<span class=\"pl-s1\"><span class=\"pl-en\">onUnmounted</span>(() <span class=\"pl-k\">=&gt;</span> <span class=\"pl-c1\">window</span>.<span class=\"pl-c1\">removeEventListener</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>scroll<span class=\"pl-pds\">'</span></span>, <span class=\"pl-smi\">listener</span>))</span>\n<span class=\"pl-s1\"></span>\n<span class=\"pl-s1\"><span class=\"pl-k\"><span class=\"pl-k\">const</span></span> style<span class=\"pl-k\">:</span> <span class=\"pl-c1\">any</span> <span class=\"pl-k\">=</span> {</span>\n<span class=\"pl-s1\">  background: <span class=\"pl-smi\">props</span>.<span class=\"pl-smi\">theme</span>,</span>\n<span class=\"pl-s1\">  zIndex: <span class=\"pl-smi\">props</span>.<span class=\"pl-c1\">zIndex</span>,</span>\n<span class=\"pl-s1\">  height: <span class=\"pl-smi\">props</span>.<span class=\"pl-c1\">height</span>,</span>\n<span class=\"pl-s1\">}</span>\n<span class=\"pl-s1\"></span>\n<span class=\"pl-s1\"><span class=\"pl-k\">if</span> (<span class=\"pl-smi\">props</span>.<span class=\"pl-smi\">placement</span> <span class=\"pl-k\">===</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>top<span class=\"pl-pds\">'</span></span>) <span class=\"pl-smi\">style</span>.<span class=\"pl-c1\">top</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0</span></span>\n<span class=\"pl-s1\"><span class=\"pl-k\">if</span> (<span class=\"pl-smi\">props</span>.<span class=\"pl-smi\">placement</span> <span class=\"pl-k\">===</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>bottom<span class=\"pl-pds\">'</span></span>) <span class=\"pl-smi\">style</span>.<span class=\"pl-c1\">bottom</span> <span class=\"pl-k\">=</span> <span class=\"pl-c1\">0</span></span>\n<span class=\"pl-s1\"></span>\n<span class=\"pl-s1\"><span class=\"pl-c\"><span class=\"pl-c\">//</span> åœ¨ `&lt;script setup&gt;` æ ‡ç­¾ä¸‹æ˜¾å¼å…¬å¼€å±æ€§ï¼Œåˆ™éœ€è¦ä½¿ç”¨ `defineExpose`</span></span>\n<span class=\"pl-s1\"><span class=\"pl-en\">defineExpose</span>({ <span class=\"pl-smi\">style</span> })</span>\n<span class=\"pl-s1\">&lt;/<span class=\"pl-ent\">script</span>&gt;</span>\n\n&lt;<span class=\"pl-ent\">template</span>&gt;\n  &lt;<span class=\"pl-ent\">div</span> <span class=\"pl-e\">id</span>=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>scroll_progress<span class=\"pl-pds\">\"</span></span> <span class=\"pl-e\">ref</span>=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>el<span class=\"pl-pds\">\"</span></span> :<span class=\"pl-e\">style</span>=<span class=\"pl-s1\"><span class=\"pl-pds\">\"</span>style<span class=\"pl-pds\">\"</span></span> /&gt;\n&lt;/<span class=\"pl-ent\">template</span>&gt;\n\n<span class=\"pl-s1\">&lt;<span class=\"pl-ent\">style</span> <span class=\"pl-e\">scoped</span>&gt;</span>\n<span class=\"pl-s1\"><span class=\"pl-e\">#scroll_progress</span> {</span>\n<span class=\"pl-s1\">  <span class=\"pl-c1\"><span class=\"pl-c1\">position</span></span>: <span class=\"pl-c1\">fixed</span>;</span>\n<span class=\"pl-s1\">  <span class=\"pl-c1\"><span class=\"pl-c1\">width</span></span>: <span class=\"pl-c1\">0<span class=\"pl-k\">%</span></span>;</span>\n<span class=\"pl-s1\">  <span class=\"pl-c1\"><span class=\"pl-c1\">transition</span></span>: width <span class=\"pl-c1\">300<span class=\"pl-k\">ms</span></span> <span class=\"pl-c1\">ease-out</span>;</span>\n<span class=\"pl-s1\">}</span>\n<span class=\"pl-s1\">&lt;/<span class=\"pl-ent\">style</span>&gt;</span></pre></div>\n<h2 dir=\"auto\">ğŸ¥ æ¼”ç¤º</h2>\n<p dir=\"auto\"><a target=\"_blank\" rel=\"noopener noreferrer nofollow\" href=\"https://user-images.githubusercontent.com/16164244/133965898-4994f377-68de-4c6c-8d19-d00a61625c06.gif\"><img src=\"https://user-images.githubusercontent.com/16164244/133965898-4994f377-68de-4c6c-8d19-d00a61625c06.gif\" alt=\"scroll_progress_bar\" data-animated-image=\"\" style=\"max-width: 100%;\"></a></p>\n<hr>\n<h2 dir=\"auto\">ğŸ”— å‚è€ƒ</h2>\n<ul dir=\"auto\">\n<li><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/Document/scroll_event\" rel=\"nofollow\">[MDN] Document: scroll event</a> - æ–‡æ¡£è§†å›¾æˆ–è€…ä¸€ä¸ªå…ƒç´ åœ¨æ»šåŠ¨æ—¶ï¼Œä¼šè§¦å‘å…ƒç´ çš„scrolläº‹ä»¶ã€‚</li>\n<li><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/MutationObserver\" rel=\"nofollow\">[MDN] MutationObserver</a> - æ¥å£æä¾›äº†ç›‘è§†å¯¹ <code class=\"notranslate\">DOMæ ‘</code> æ‰€åšæ›´æ”¹çš„èƒ½åŠ›ã€‚å®ƒè¢«è®¾è®¡ä¸ºæ—§çš„ <code class=\"notranslate\">Mutation Events</code> åŠŸèƒ½çš„æ›¿ä»£å“ï¼Œè¯¥åŠŸèƒ½æ˜¯ <code class=\"notranslate\">DOM3 Events</code> è§„èŒƒçš„ä¸€éƒ¨åˆ†ã€‚</li>\n<li><a href=\"https://v3.vuejs.org/\" rel=\"nofollow\">Vue3 API</a>\n<ul dir=\"auto\">\n<li><a href=\"https://v3.vuejs.org/api/options-data.html#props\" rel=\"nofollow\">props</a></li>\n<li><a href=\"https://v3.vuejs.org/api/sfc-script-setup.html#basic-syntax\" rel=\"nofollow\">&lt;script setup&gt;</a></li>\n<li><a href=\"https://v3.vuejs.org/api/composition-api.html#lifecycle-hooks\" rel=\"nofollow\">Lifecycle Hooks</a></li>\n<li><a href=\"https://v3.vuejs.org/api/sfc-script-setup.html#defineprops-and-defineemits\" rel=\"nofollow\">defineProps and defineEmits</a></li>\n<li><a href=\"https://v3.vuejs.org/api/sfc-script-setup.html#defineexpose\" rel=\"nofollow\">defineExpose</a></li>\n</ul>\n</li>\n</ul>","category":{"name":"Notes"},"labels":{"edges":[{"node":{"id":"MDU6TGFiZWwzMDUyMDQ4NTAz","name":"vue"}},{"node":{"id":"MDU6TGFiZWwzMDg2MDYxNzMz","name":"blog"}},{"node":{"id":"MDU6TGFiZWwzMTk2OTc2MDIx","name":"wechat-post"}}]},"reactions":{"totalCount":0,"edges":[]},"comments":{"edges":[]}}